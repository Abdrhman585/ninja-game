<!DOCTYPE html>
<html dir='rtl' lang='ar'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no'>
    <title>ØªØ­Ø¯ÙŠ Ø§Ù„Ù†ÙŠÙ†Ø¬Ø§ Ø§Ù„Ù…Ø·ÙˆØ±</title>
    <style>
        body { margin: 0; background: #0f0c29; color: #fff; text-align: center; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        canvas { background: linear-gradient(to bottom, #24243e, #302b63, #0f0c29); display: block; margin: 10px auto; border: 4px solid #00d2ff; border-radius: 20px; box-shadow: 0 0 20px #00d2ff; touch-action: none; }
        .stats { display: flex; justify-content: space-around; font-size: 18px; padding: 10px; background: rgba(0,0,0,0.5); }
        .level-up { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 40px; color: gold; display: none; text-shadow: 2px 2px #000; }
    </style>
</head>
<body>
    <div class="stats">
        <div>Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="score">0</span></div>
        <div>Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <span id="level">1</span></div>
        <div id="livesDisplay">ðŸ’›ðŸ’šðŸ’™</div>
    </div>
    <div id="msg" class="level-up">Ù…Ø³ØªÙˆÙ‰ Ø¬Ø¯ÙŠØ¯! âš¡</div>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth - 20;
        canvas.height = 450;

        let score = 0; let lives = 6; let level = 1; let gameSpeed = 4;
        let player = { x: canvas.width/2 - 35, y: canvas.height - 60, w: 70, h: 20, color: '#00d2ff' };
        let ball = { x: Math.random()*canvas.width, y: -20, r: 15, type: 'gold' };

        const types = {
            gold: { c: '#f1c40f', p: 1 },
            green: { c: '#2ecc71', p: 5 },
            blue: { c: '#3498db', p: 0 },
            bomb: { c: '#000', p: 0 }
        };

        function showMsg() {
            let m = document.getElementById('msg');
            m.style.display = 'block';
            setTimeout(() => m.style.display = 'none', 1000);
        }

        function resetBall() {
            ball.y = -20; ball.x = 20 + Math.random()*(canvas.width-40);
            let r = Math.random();
            if(r < 0.6) ball.type = 'gold';
            else if(r < 0.8) ball.type = 'bomb';
            else if(r < 0.95) ball.type = 'green';
            else ball.type = 'blue';
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Ø±Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø¨ØªØ£Ø«ÙŠØ± Ù†ÙŠÙˆÙ†
            ctx.shadowBlur = 15; ctx.shadowColor = player.color;
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.w, player.h);
            ctx.shadowBlur = 0;

            // Ø±Ø³Ù… Ø§Ù„ÙƒØ±Ø©
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2);
            ctx.fillStyle = types[ball.type].c;
            ctx.fill();
            if(ball.type === 'bomb') { ctx.strokeStyle = 'red'; ctx.lineWidth = 3; ctx.stroke(); }
            ctx.closePath();

            ball.y += gameSpeed;

            // Ø³Ù‚ÙˆØ· Ø§Ù„ÙƒØ±Ø©
            if (ball.y > canvas.height) {
                if(ball.type !== 'bomb') {
                    lives--; updateUI();
                    if(lives <= 0) { alert('Game Over! Points: ' + score); location.reload(); }
                }
                resetBall();
            }

            // Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù…
            if (ball.y + ball.r > player.y && ball.x > player.x && ball.x < player.x + player.w) {
                if(ball.type === 'bomb') {
                    lives -= 2; // Ø§Ù„Ù‚Ù†Ø¨Ù„Ø© ØªÙ†Ù‚Øµ Ù‚Ù„Ø¨ ÙƒØ§Ù…Ù„
                } else {
                    score += types[ball.type].p;
                    if(ball.type === 'blue' && lives < 6) lives++;
                    if(score >= level * 20) { 
                        level++; gameSpeed += 1.5; showMsg(); 
                        player.color = level % 2 === 0 ? '#ff00ff' : '#00d2ff';
                    }
                }
                updateUI(); resetBall();
            }
            requestAnimationFrame(draw);
        }

        function updateUI() {
            document.getElementById('score').innerText = score;
            document.getElementById('level').innerText = level;
            let h = ""; let full = Math.floor(lives/2);
            for(let i=0; i<full; i++) h += "â¤ï¸";
            if(lives%2) h += "ðŸ’”";
            document.getElementById('livesDisplay').innerText = h;
        }

        canvas.addEventListener('touchmove', (e) => {
            player.x = e.touches[0].clientX - canvas.offsetLeft - player.w/2;
        });

        draw();
    </script>
</body>
</html>
